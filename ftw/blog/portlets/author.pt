<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      tal:omit-tag="">
<tal:block tal:define="author_id  python:context.Creator();
                       mtool python:context.portal_membership;
                       authorinfo python: mtool.getMemberInfo(author_id);"
           condition="view/show"
           i18n:domain="plone">

  <dl tal:define="portrait python: mtool.getPersonalPortrait(author_id);"
      class="portlet portletAboutAuthor">

    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
        <span i18n:translate="">About the author</span>
        <span class="portletTopRight"></span>
    </dt>
    <dd class="portletItem">
      <img src=""
           alt=""
           class="authorPortrait image-left"
           tal:attributes="src portrait/absolute_url" />

      <p tal:define="author_fullname authorinfo/fullname;
                     cropText nocall:context/@@plone/cropText;
                     description authorinfo/description;
                     cropped python:cropText(description, 120, '...')">

        <strong><tal:x condition="author_fullname" replace="author_fullname"/><tal:x condition="not: author_fullname" replace="author_id"/></strong>,
        <tal:x replace="cropped"/>
        <a href="#"
           class="authorMore"
           tal:attributes="href string:${context/@@plone_portal_state/navigation_root_url}/author/${author_id}"> &#62; More</a>
      </p>
    </dd>
  </dl>

  <dl tal:define="author_content python:context.portal_catalog.searchResults(dict(Creator=author_id,Type='BlogEntry', sort_on='created', sort_order='reverse'))[:5];"
      tal:condition="author_content"
      class="portlet portletAuthorLatestEntries">

    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
        <span i18n:translate="heading_author_content">Latest blog entries created by this user</span>
        <span class="portletTopRight"></span>
    </dt>

    <metal:user-content-listing define-macro="user_content_listing">
      <tal:repeat repeat="item author_content">
        <dd class="portletItem">
          <p>
            <a href=""
               tal:attributes="href item/getURL"
               tal:content="item/pretty_title_or_id">title</a>
          </p>
          <p tal:define="toLocalizedTime nocall: context/@@plone/toLocalizedTime;"
             tal:content="python:toLocalizedTime(item.Date)">
            Date
          </p>
        </dd>
      </tal:repeat>
    </metal:user-content-listing>

  </dl>

</tal:block>
</html>
